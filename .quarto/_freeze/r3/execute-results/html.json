{
  "hash": "8719519be12d62a0ea01688d42e23d6f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"RQ3 — On-Ice vs Off-Ice Impact Delta\"\nformat:\n  html:\n    theme: cosmo\n    toc: true\n    code-fold: true\n---\n\n\n\n\n\n## Research Question 3 Overview\n\nThe third research question focuses on identifying **which performance metrics most effectively distinguish high-impact skaters from low-impact skaters**. Unlike RQ1 and RQ2, which examined shift efficiency and workload patterns, this section adopts a *comparative and multivariate perspective*. The goal is to determine which statistical indicators provide the strongest separation between top-performing and bottom-performing players.\n\nUnderstanding these differentiating metrics is valuable for player evaluation, roster construction, and strategic decision-making. By isolating the variables that matter most, analysts can move beyond raw counts and focus on efficiency-driven indicators.\n\n---\n\n## Data Preparation\n\nWe begin by loading the skaters dataset and preparing a clean analytical table. Only numeric variables relevant to on-ice performance are retained for analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyverse' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tibble' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'knitr' was built under R version 4.5.2\n```\n\n\n:::\n:::\n\n\n\n\n\n# Load dataset\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfile_path <- \"D:/GMU homeworks/STAT515/final proj/skaters.csv\"\ndf <- read_csv(file_path, show_col_types = FALSE)\n```\n:::\n\n\n\n\n\n# Inspect column names\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"playerId\"                                               \n  [2] \"season\"                                                 \n  [3] \"name\"                                                   \n  [4] \"team\"                                                   \n  [5] \"position\"                                               \n  [6] \"situation\"                                              \n  [7] \"games_played\"                                           \n  [8] \"icetime\"                                                \n  [9] \"shifts\"                                                 \n [10] \"gameScore\"                                              \n [11] \"onIce_xGoalsPercentage\"                                 \n [12] \"offIce_xGoalsPercentage\"                                \n [13] \"onIce_corsiPercentage\"                                  \n [14] \"offIce_corsiPercentage\"                                 \n [15] \"onIce_fenwickPercentage\"                                \n [16] \"offIce_fenwickPercentage\"                               \n [17] \"iceTimeRank\"                                            \n [18] \"I_F_xOnGoal\"                                            \n [19] \"I_F_xGoals\"                                             \n [20] \"I_F_xRebounds\"                                          \n [21] \"I_F_xFreeze\"                                            \n [22] \"I_F_xPlayStopped\"                                       \n [23] \"I_F_xPlayContinuedInZone\"                               \n [24] \"I_F_xPlayContinuedOutsideZone\"                          \n [25] \"I_F_flurryAdjustedxGoals\"                               \n [26] \"I_F_scoreVenueAdjustedxGoals\"                           \n [27] \"I_F_flurryScoreVenueAdjustedxGoals\"                     \n [28] \"I_F_primaryAssists\"                                     \n [29] \"I_F_secondaryAssists\"                                   \n [30] \"I_F_shotsOnGoal\"                                        \n [31] \"I_F_missedShots\"                                        \n [32] \"I_F_blockedShotAttempts\"                                \n [33] \"I_F_shotAttempts\"                                       \n [34] \"I_F_points\"                                             \n [35] \"I_F_goals\"                                              \n [36] \"I_F_rebounds\"                                           \n [37] \"I_F_reboundGoals\"                                       \n [38] \"I_F_freeze\"                                             \n [39] \"I_F_playStopped\"                                        \n [40] \"I_F_playContinuedInZone\"                                \n [41] \"I_F_playContinuedOutsideZone\"                           \n [42] \"I_F_savedShotsOnGoal\"                                   \n [43] \"I_F_savedUnblockedShotAttempts\"                         \n [44] \"penalties\"                                              \n [45] \"I_F_penalityMinutes\"                                    \n [46] \"I_F_faceOffsWon\"                                        \n [47] \"I_F_hits\"                                               \n [48] \"I_F_takeaways\"                                          \n [49] \"I_F_giveaways\"                                          \n [50] \"I_F_lowDangerShots\"                                     \n [51] \"I_F_mediumDangerShots\"                                  \n [52] \"I_F_highDangerShots\"                                    \n [53] \"I_F_lowDangerxGoals\"                                    \n [54] \"I_F_mediumDangerxGoals\"                                 \n [55] \"I_F_highDangerxGoals\"                                   \n [56] \"I_F_lowDangerGoals\"                                     \n [57] \"I_F_mediumDangerGoals\"                                  \n [58] \"I_F_highDangerGoals\"                                    \n [59] \"I_F_scoreAdjustedShotsAttempts\"                         \n [60] \"I_F_unblockedShotAttempts\"                              \n [61] \"I_F_scoreAdjustedUnblockedShotAttempts\"                 \n [62] \"I_F_dZoneGiveaways\"                                     \n [63] \"I_F_xGoalsFromxReboundsOfShots\"                         \n [64] \"I_F_xGoalsFromActualReboundsOfShots\"                    \n [65] \"I_F_reboundxGoals\"                                      \n [66] \"I_F_xGoals_with_earned_rebounds\"                        \n [67] \"I_F_xGoals_with_earned_rebounds_scoreAdjusted\"          \n [68] \"I_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted\"    \n [69] \"I_F_shifts\"                                             \n [70] \"I_F_oZoneShiftStarts\"                                   \n [71] \"I_F_dZoneShiftStarts\"                                   \n [72] \"I_F_neutralZoneShiftStarts\"                             \n [73] \"I_F_flyShiftStarts\"                                     \n [74] \"I_F_oZoneShiftEnds\"                                     \n [75] \"I_F_dZoneShiftEnds\"                                     \n [76] \"I_F_neutralZoneShiftEnds\"                               \n [77] \"I_F_flyShiftEnds\"                                       \n [78] \"faceoffsWon\"                                            \n [79] \"faceoffsLost\"                                           \n [80] \"timeOnBench\"                                            \n [81] \"penalityMinutes\"                                        \n [82] \"penalityMinutesDrawn\"                                   \n [83] \"penaltiesDrawn\"                                         \n [84] \"shotsBlockedByPlayer\"                                   \n [85] \"OnIce_F_xOnGoal\"                                        \n [86] \"OnIce_F_xGoals\"                                         \n [87] \"OnIce_F_flurryAdjustedxGoals\"                           \n [88] \"OnIce_F_scoreVenueAdjustedxGoals\"                       \n [89] \"OnIce_F_flurryScoreVenueAdjustedxGoals\"                 \n [90] \"OnIce_F_shotsOnGoal\"                                    \n [91] \"OnIce_F_missedShots\"                                    \n [92] \"OnIce_F_blockedShotAttempts\"                            \n [93] \"OnIce_F_shotAttempts\"                                   \n [94] \"OnIce_F_goals\"                                          \n [95] \"OnIce_F_rebounds\"                                       \n [96] \"OnIce_F_reboundGoals\"                                   \n [97] \"OnIce_F_lowDangerShots\"                                 \n [98] \"OnIce_F_mediumDangerShots\"                              \n [99] \"OnIce_F_highDangerShots\"                                \n[100] \"OnIce_F_lowDangerxGoals\"                                \n[101] \"OnIce_F_mediumDangerxGoals\"                             \n[102] \"OnIce_F_highDangerxGoals\"                               \n[103] \"OnIce_F_lowDangerGoals\"                                 \n[104] \"OnIce_F_mediumDangerGoals\"                              \n[105] \"OnIce_F_highDangerGoals\"                                \n[106] \"OnIce_F_scoreAdjustedShotsAttempts\"                     \n[107] \"OnIce_F_unblockedShotAttempts\"                          \n[108] \"OnIce_F_scoreAdjustedUnblockedShotAttempts\"             \n[109] \"OnIce_F_xGoalsFromxReboundsOfShots\"                     \n[110] \"OnIce_F_xGoalsFromActualReboundsOfShots\"                \n[111] \"OnIce_F_reboundxGoals\"                                  \n[112] \"OnIce_F_xGoals_with_earned_rebounds\"                    \n[113] \"OnIce_F_xGoals_with_earned_rebounds_scoreAdjusted\"      \n[114] \"OnIce_F_xGoals_with_earned_rebounds_scoreFlurryAdjusted\"\n[115] \"OnIce_A_xOnGoal\"                                        \n[116] \"OnIce_A_xGoals\"                                         \n[117] \"OnIce_A_flurryAdjustedxGoals\"                           \n[118] \"OnIce_A_scoreVenueAdjustedxGoals\"                       \n[119] \"OnIce_A_flurryScoreVenueAdjustedxGoals\"                 \n[120] \"OnIce_A_shotsOnGoal\"                                    \n[121] \"OnIce_A_missedShots\"                                    \n[122] \"OnIce_A_blockedShotAttempts\"                            \n[123] \"OnIce_A_shotAttempts\"                                   \n[124] \"OnIce_A_goals\"                                          \n[125] \"OnIce_A_rebounds\"                                       \n[126] \"OnIce_A_reboundGoals\"                                   \n[127] \"OnIce_A_lowDangerShots\"                                 \n[128] \"OnIce_A_mediumDangerShots\"                              \n[129] \"OnIce_A_highDangerShots\"                                \n[130] \"OnIce_A_lowDangerxGoals\"                                \n[131] \"OnIce_A_mediumDangerxGoals\"                             \n[132] \"OnIce_A_highDangerxGoals\"                               \n[133] \"OnIce_A_lowDangerGoals\"                                 \n[134] \"OnIce_A_mediumDangerGoals\"                              \n[135] \"OnIce_A_highDangerGoals\"                                \n[136] \"OnIce_A_scoreAdjustedShotsAttempts\"                     \n[137] \"OnIce_A_unblockedShotAttempts\"                          \n[138] \"OnIce_A_scoreAdjustedUnblockedShotAttempts\"             \n[139] \"OnIce_A_xGoalsFromxReboundsOfShots\"                     \n[140] \"OnIce_A_xGoalsFromActualReboundsOfShots\"                \n[141] \"OnIce_A_reboundxGoals\"                                  \n[142] \"OnIce_A_xGoals_with_earned_rebounds\"                    \n[143] \"OnIce_A_xGoals_with_earned_rebounds_scoreAdjusted\"      \n[144] \"OnIce_A_xGoals_with_earned_rebounds_scoreFlurryAdjusted\"\n[145] \"OffIce_F_xGoals\"                                        \n[146] \"OffIce_A_xGoals\"                                        \n[147] \"OffIce_F_shotAttempts\"                                  \n[148] \"OffIce_A_shotAttempts\"                                  \n[149] \"xGoalsForAfterShifts\"                                   \n[150] \"xGoalsAgainstAfterShifts\"                               \n[151] \"corsiForAfterShifts\"                                    \n[152] \"corsiAgainstAfterShifts\"                                \n[153] \"fenwickForAfterShifts\"                                  \n[154] \"fenwickAgainstAfterShifts\"                              \n```\n\n\n:::\n:::\n\n\n\n\n\nTo ensure consistency, we convert all applicable performance metrics to numeric format while preserving identifying variables such as season and team.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_clean <- df %>%\nmutate(across(where(is.character), ~ suppressWarnings(as.numeric(.))))\n```\n:::\n\n\n\n\n\n---\n\n## Defining High- and Low-Impact Skaters\n\nTo differentiate player impact levels, we construct a composite **impact score** based on expected goal contribution after shifts. This score reflects a player’s net influence on scoring chances.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_clean <- df_clean %>%\nmutate(\nnet_xg = xGoalsForAfterShifts - xGoalsAgainstAfterShifts\n)\n```\n:::\n\n\n\n\n\nPlayers are then divided into **high-impact** and **low-impact** groups using quartiles of the net expected goals distribution.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantiles <- quantile(df_clean$net_xg, probs = c(0.25, 0.75), na.rm = TRUE)\n\nimpact_df <- df_clean %>%\nfilter(!is.na(net_xg)) %>%\nmutate(\nimpact_group = case_when(\nnet_xg >= quantiles[2] ~ \"High Impact\",\nnet_xg <= quantiles[1] ~ \"Low Impact\",\nTRUE ~ NA_character_\n)\n) %>%\nfilter(!is.na(impact_group))\n```\n:::\n\n\n\n\n\n---\n\n## Comparing Performance Metrics\n\nWe compare key metrics between high-impact and low-impact skaters, focusing on workload, scoring contribution, and possession-related indicators.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetrics <- c(\n\"shifts\",\n\"xGoalsForAfterShifts\",\n\"xGoalsAgainstAfterShifts\",\n\"net_xg\"\n)\n\nsummary_table <- impact_df %>%\ngroup_by(impact_group) %>%\nsummarise(across(all_of(metrics), ~ mean(.x, na.rm = TRUE)))\n\nkable(summary_table, digits = 3,\ncaption = \"Average Performance Metrics by Impact Group\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Average Performance Metrics by Impact Group\n\n|impact_group |  shifts| xGoalsForAfterShifts| xGoalsAgainstAfterShifts| net_xg|\n|:------------|-------:|--------------------:|------------------------:|------:|\n|High Impact  | 536.424|                1.389|                    0.282|  1.106|\n|Low Impact   | 393.062|                0.071|                    0.125| -0.054|\n\n\n:::\n:::\n\n\n\n\n\n---\n\n## Visualization of Group Differences\n\nThe following visualization highlights how key metrics differ between high-impact and low-impact skaters.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimpact_long <- impact_df %>%\nselect(impact_group, all_of(metrics)) %>%\npivot_longer(cols = -impact_group,\nnames_to = \"metric\",\nvalues_to = \"value\")\n\nggplot(impact_long, aes(x = impact_group, y = value, fill = impact_group)) +\ngeom_boxplot(alpha = 0.7) +\nfacet_wrap(~ metric, scales = \"free\") +\nlabs(title = \"Metric Distributions by Skater Impact Level\",\nx = \"Impact Group\",\ny = \"Value\") +\ntheme_minimal() +\ntheme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](r3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n---\n\n## Interpretation\n\nHigh-impact skaters consistently demonstrate higher values of expected goals for after shifts and substantially stronger net expected goal contributions. In contrast, low-impact skaters tend to allow more expected goals against, reducing their overall on-ice effectiveness.\n\nInterestingly, the number of shifts alone does not fully explain impact. While high-impact players often log more shifts, **efficiency-based metrics**—particularly net expected goals—provide clearer differentiation. This reinforces the importance of advanced analytics over raw usage statistics.\n\n---\n\n## Conclusion\n\nThis analysis shows that **net expected goal contribution after shifts** is the most powerful single metric for separating high- and low-impact skaters. Supporting metrics such as expected goals for and against further clarify player effectiveness, while workload indicators play a secondary role.\n\nThese findings complement RQ1 and RQ2 by shifting the focus from descriptive patterns to **comparative performance evaluation**, offering actionable insight for coaches, analysts, and front offices.\n\nIn the next section (`rq3_details.qmd`), we extend this analysis with deeper statistical testing and robustness checks.\n",
    "supporting": [
      "r3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}